disp("Momin")
im = imread('C:\Users\z2m09\Desktop\bottles\inputs\bottle_crate_02.png');
u = graythresh(im);
im2 = im2bw(im,u);
circ_1 = 1350; % aprox area of one circle
area_image=bwarea(im2); %area of all circles
N_circles = floor(area_image/circ_1)
disp(N_circles)

function [BW,maskedImage] = segmentImage(X)
Y = imread('C:\Users\z2m09\Desktop\bottles\inputs\bottle_crate_02.png');
img = imadjust(Y);

% Create empty mask
BW = false(size(img,1),size(img,2));

% Draw ROIs

xPos = [221.7339 221.5126 220.8540 219.7746 218.3007 216.4687 214.3237 211.9185 209.3124 206.5695 203.7573 200.9452 198.2023 195.5961 193.1910 191.0460 189.2140 187.7401 186.6606 186.0021 185.7808 186.0021 186.6606 187.7401 189.2140 191.0460 193.1910 195.5961 198.2023 200.9452 203.7573 206.5695 209.3124 211.9185 214.3237 216.4687 218.3007 219.7746 220.8540 221.5126 221.7339];
yPos = [107.3839 110.1961 112.9390 115.5451 117.9503 120.0953 121.9272 123.4011 124.4806 125.1391 125.3605 125.1391 124.4806 123.4011 121.9272 120.0953 117.9503 115.5451 112.9390 110.1961 107.3839 104.5718 101.8288 99.2227 96.8176 94.6726 92.8406 91.3667 90.2872 89.6287 89.4074 89.6287 90.2872 91.3667 92.8406 94.6726 96.8176 99.2227 101.8288 104.5718 107.3839];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [323.4319 323.2162 322.5742 321.5219 320.0850 318.2991 316.2080 313.8632 311.3226 308.6486 305.9072 303.1657 300.4917 297.9511 295.6064 293.5153 291.7293 290.2925 289.2401 288.5981 288.3824 288.5981 289.2401 290.2925 291.7293 293.5153 295.6064 297.9511 300.4917 303.1657 305.9072 308.6486 311.3226 313.8632 316.2080 318.2991 320.0850 321.5219 322.5742 323.2162 323.4319];
yPos = [101.6487 104.3902 107.0641 109.6048 111.9495 114.0406 115.8265 117.2634 118.3157 118.9577 119.1735 118.9577 118.3157 117.2634 115.8265 114.0406 111.9495 109.6048 107.0641 104.3902 101.6487 98.9072 96.2332 93.6926 91.3479 89.2568 87.4708 86.0340 84.9816 84.3397 84.1239 84.3397 84.9816 86.0340 87.4708 89.2568 91.3479 93.6926 96.2332 98.9072 101.6487];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [432.6373 432.4502 431.8934 430.9807 429.7345 428.1856 426.3720 424.3384 422.1349 419.8158 417.4381 415.0604 412.7413 410.5378 408.5042 406.6906 405.1417 403.8955 402.9828 402.4260 402.2389 402.4260 402.9828 403.8955 405.1417 406.6906 408.5042 410.5378 412.7413 415.0604 417.4381 419.8158 422.1349 424.3384 426.3720 428.1856 429.7345 430.9807 431.8934 432.4502 432.6373];
yPos = [106.8625 109.2402 111.5593 113.7628 115.7964 117.6100 119.1589 120.4051 121.3178 121.8746 122.0617 121.8746 121.3178 120.4051 119.1589 117.6100 115.7964 113.7628 111.5593 109.2402 106.8625 104.4848 102.1657 99.9622 97.9287 96.1151 94.5661 93.3199 92.4072 91.8504 91.6633 91.8504 92.4072 93.3199 94.5661 96.1151 97.9287 99.9622 102.1657 104.4848 106.8625];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [530.3421 530.1312 529.5049 528.4823 527.0945 525.3835 523.4015 521.2085 518.8713 516.4609 514.0505 511.7133 509.5203 507.5383 505.8273 504.4395 503.4169 502.7906 502.5798 502.7906 503.4169 504.4395 505.8273 507.5383 509.5203 511.7133 514.0505 516.4609 518.8713 521.2085 523.4015 525.3835 527.0945 528.4823 529.5049 530.1312 530.3421];
yPos = [107.3839 109.7943 112.1315 114.3245 116.3065 118.0175 119.4053 120.4279 121.0542 121.2651 121.0542 120.4279 119.4053 118.0175 116.3065 114.3245 112.1315 109.7943 107.3839 104.9735 102.6363 100.4433 98.4613 96.7503 95.3625 94.3399 93.7136 93.5028 93.7136 94.3399 95.3625 96.7503 98.4613 100.4433 102.6363 104.9735 107.3839];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [221.1718 220.9510 220.2940 219.2169 217.7464 215.9186 213.7785 211.3788 208.7786 206.0419 203.2362 200.4304 197.6937 195.0935 192.6938 190.5537 188.7259 187.2554 186.1783 185.5213 185.3005 185.5213 186.1783 187.2554 188.7259 190.5537 192.6938 195.0935 197.6937 200.4304 203.2362 206.0419 208.7786 211.3788 213.7785 215.9186 217.7464 219.2169 220.2940 220.9510 221.1718];
yPos = [206.4470 209.2528 211.9895 214.5897 216.9894 219.1295 220.9573 222.4278 223.5049 224.1619 224.3827 224.1619 223.5049 222.4278 220.9573 219.1295 216.9894 214.5897 211.9895 209.2528 206.4470 203.6413 200.9046 198.3044 195.9047 193.7646 191.9368 190.4663 189.3892 188.7322 188.5114 188.7322 189.3892 190.4663 191.9368 193.7646 195.9047 198.3044 200.9046 203.6413 206.4470];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [329.3647 329.1401 328.4717 327.3760 325.8801 324.0206 321.8435 319.4023 316.7572 313.9732 311.1189 308.2646 305.4806 302.8355 300.3943 298.2172 296.3577 294.8618 293.7661 293.0977 292.8731 293.0977 293.7661 294.8618 296.3577 298.2172 300.3943 302.8355 305.4806 308.2646 311.1189 313.9732 316.7572 319.4023 321.8435 324.0206 325.8801 327.3760 328.4717 329.1401 329.3647];
yPos = [211.6609 214.5152 217.2992 219.9443 222.3855 224.5626 226.4221 227.9180 229.0137 229.6821 229.9067 229.6821 229.0137 227.9180 226.4221 224.5626 222.3855 219.9443 217.2992 214.5152 211.6609 208.8066 206.0226 203.3775 200.9363 198.7592 196.8997 195.4038 194.3081 193.6397 193.4151 193.6397 194.3081 195.4038 196.8997 198.7592 200.9363 203.3775 206.0226 208.8066 211.6609];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [432.9307 432.7359 432.1554 431.2010 429.8922 428.2556 426.3245 424.1382 421.7413 419.1825 416.5139 413.7899 411.0659 408.3973 405.8385 403.4416 401.2553 399.3242 397.6876 396.3788 395.4244 394.8439 394.6491 394.8439 395.4244 396.3788 397.6876 399.3242 401.2553 403.4416 405.8385 408.3973 411.0659 413.7899 416.5139 419.1825 421.7413 424.1382 426.3245 428.2556 429.8922 431.2010 432.1554 432.7359 432.9307];
yPos = [207.4898 210.2138 212.8824 215.4412 217.8381 220.0244 221.9555 223.5921 224.9009 225.8553 226.4358 226.6307 226.4358 225.8553 224.9009 223.5921 221.9555 220.0244 217.8381 215.4412 212.8824 210.2138 207.4898 204.7658 202.0972 199.5384 197.1415 194.9552 193.0241 191.3875 190.0787 189.1243 188.5438 188.3490 188.5438 189.1243 190.0787 191.3875 193.0241 194.9552 197.1415 199.5384 202.0972 204.7658 207.4898];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [533.8436 533.6167 532.9418 531.8354 530.3247 528.4470 526.2485 523.7833 521.1122 518.3009 515.4186 512.5363 509.7249 507.0538 504.5886 502.3901 500.5124 499.0018 497.8953 497.2204 496.9936 497.2204 497.8953 499.0018 500.5124 502.3901 504.5886 507.0538 509.7249 512.5363 515.4186 518.3009 521.1122 523.7833 526.2485 528.4470 530.3247 531.8354 532.9418 533.6167 533.8436];
yPos = [211.6609 214.5432 217.3545 220.0257 222.4908 224.6893 226.5670 228.0777 229.1841 229.8591 230.0859 229.8591 229.1841 228.0777 226.5670 224.6893 222.4908 220.0257 217.3545 214.5432 211.6609 208.7786 205.9673 203.2961 200.8309 198.6324 196.7547 195.2441 194.1377 193.4627 193.2359 193.4627 194.1377 195.2441 196.7547 198.6324 200.8309 203.2961 205.9673 208.7786 211.6609];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [114.4645 114.2454 113.5948 112.5325 111.0907 109.3133 107.2542 104.9761 102.5481 100.0440 97.5399 95.1119 92.8337 90.7746 88.9972 87.5554 86.4931 85.8425 85.6235 85.8425 86.4931 87.5554 88.9972 90.7746 92.8337 95.1119 97.5399 100.0440 102.5481 104.9761 107.2542 109.3133 111.0907 112.5325 113.5948 114.2454 114.4645];
yPos = [304.9888 307.4929 309.9209 312.1991 314.2581 316.0356 317.4773 318.5397 319.1902 319.4093 319.1902 318.5397 317.4773 316.0356 314.2581 312.1991 309.9209 307.4929 304.9888 302.4847 300.0567 297.7785 295.7195 293.9420 292.5003 291.4379 290.7874 290.5683 290.7874 291.4379 292.5003 293.9420 295.7195 297.7785 300.0567 302.4847 304.9888];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [223.1259 222.9388 222.3820 221.4693 220.2231 218.6742 216.8606 214.8270 212.6235 210.3044 207.9267 205.5490 203.2299 201.0264 198.9928 197.1792 195.6303 194.3841 193.4714 192.9146 192.7275 192.9146 193.4714 194.3841 195.6303 197.1792 198.9928 201.0264 203.2299 205.5490 207.9267 210.3044 212.6235 214.8270 216.8606 218.6742 220.2231 221.4693 222.3820 222.9388 223.1259];
yPos = [311.2454 313.6231 315.9422 318.1457 320.1793 321.9929 323.5418 324.7880 325.7007 326.2575 326.4446 326.2575 325.7007 324.7880 323.5418 321.9929 320.1793 318.1457 315.9422 313.6231 311.2454 308.8677 306.5486 304.3451 302.3115 300.4980 298.9490 297.7028 296.7901 296.2333 296.0462 296.2333 296.7901 297.7028 298.9490 300.4980 302.3115 304.3451 306.5486 308.8677 311.2454];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [325.4390 325.2113 324.5340 323.4237 321.9078 320.0235 317.8173 315.3436 312.6631 309.8419 306.9495 304.0571 301.2360 298.5555 296.0817 293.8755 291.9912 290.4753 289.3650 288.6877 288.4600 288.6877 289.3650 290.4753 291.9912 293.8755 296.0817 298.5555 301.2360 304.0571 306.9495 309.8419 312.6631 315.3436 317.8173 320.0235 321.9078 323.4237 324.5340 325.2113 325.4390];
yPos = [309.1599 312.0523 314.8734 317.5539 320.0277 322.2339 324.1182 325.6341 326.7444 327.4217 327.6493 327.4217 326.7444 325.6341 324.1182 322.2339 320.0277 317.5539 314.8734 312.0523 309.1599 306.2675 303.4463 300.7658 298.2920 296.0858 294.2016 292.6856 291.5753 290.8980 290.6704 290.8980 291.5753 292.6856 294.2016 296.0858 298.2920 300.7658 303.4463 306.2675 309.1599];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [428.2374 428.0146 427.3517 426.2650 424.7814 422.9373 420.7781 418.3570 415.7336 412.9725 410.1417 407.3109 404.5498 401.9264 399.5053 397.3461 395.5020 394.0183 392.9317 392.2688 392.0460 392.2688 392.9317 394.0183 395.5020 397.3461 399.5053 401.9264 404.5498 407.3109 410.1417 412.9725 415.7336 418.3570 420.7781 422.9373 424.7814 426.2650 427.3517 428.0146 428.2374];
yPos = [309.6813 312.5120 315.2731 317.8965 320.3176 322.4768 324.3210 325.8046 326.8913 327.5541 327.7769 327.5541 326.8913 325.8046 324.3210 322.4768 320.3176 317.8965 315.2731 312.5120 309.6813 306.8505 304.0894 301.4660 299.0449 296.8857 295.0416 293.5579 292.4713 291.8084 291.5856 291.8084 292.4713 293.5579 295.0416 296.8857 299.0449 301.4660 304.0894 306.8505 309.6813];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [531.5790 531.3864 530.8136 529.8744 528.5922 526.9984 525.1323 523.0398 520.7725 518.3863 515.9397 513.4932 511.1069 508.8397 506.7472 504.8811 503.2873 502.0051 501.0659 500.4930 500.3005 500.4930 501.0659 502.0051 503.2873 504.8811 506.7472 508.8397 511.1069 513.4932 515.9397 518.3863 520.7725 523.0398 525.1323 526.9984 528.5922 529.8744 530.8136 531.3864 531.5790];
yPos = [313.8523 316.2989 318.6851 320.9524 323.0449 324.9110 326.5048 327.7870 328.7262 329.2991 329.4916 329.2991 328.7262 327.7870 326.5048 324.9110 323.0449 320.9524 318.6851 316.2989 313.8523 311.4058 309.0195 306.7523 304.6598 302.7937 301.1999 299.9177 298.9785 298.4056 298.2131 298.4056 298.9785 299.9177 301.1999 302.7937 304.6598 306.7523 309.0195 311.4058 313.8523];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [118.6363 118.4139 117.7519 116.6667 115.1851 113.3434 111.1871 108.7693 106.1495 103.3921 100.5651 97.7382 94.9808 92.3610 89.9432 87.7869 85.9452 84.4636 83.3784 82.7164 82.4939 82.7164 83.3784 84.4636 85.9452 87.7869 89.9432 92.3610 94.9808 97.7382 100.5651 103.3921 106.1495 108.7693 111.1871 113.3434 115.1851 116.6667 117.7519 118.4139 118.6363];
yPos = [401.9664 404.7934 407.5507 410.1705 412.5884 414.7447 416.5863 418.0680 419.1531 419.8151 420.0376 419.8151 419.1531 418.0680 416.5863 414.7447 412.5884 410.1705 407.5507 404.7934 401.9664 399.1394 396.3821 393.7622 391.3444 389.1881 387.3465 385.8648 384.7797 384.1177 383.8952 384.1177 384.7797 385.8648 387.3465 389.1881 391.3444 393.7622 396.3821 399.1394 401.9664];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [223.0533 222.8414 222.2109 221.1774 219.7662 218.0122 215.9586 213.6558 211.1606 208.5345 205.8420 203.1496 200.5234 198.0283 195.7255 193.6718 191.9178 190.5067 189.4731 188.8426 188.6307 188.8426 189.4731 190.5067 191.9178 193.6718 195.7255 198.0283 200.5234 203.1496 205.8420 208.5345 211.1606 213.6558 215.9586 218.0122 219.7662 221.1774 222.2109 222.8414 223.0533];
yPos = [409.2658 411.9582 414.5844 417.0795 419.3823 421.4360 423.1900 424.6011 425.6347 426.2652 426.4771 426.2652 425.6347 424.6011 423.1900 421.4360 419.3823 417.0795 414.5844 411.9582 409.2658 406.5733 403.9472 401.4520 399.1492 397.0956 395.3416 393.9304 392.8969 392.2664 392.0545 392.2664 392.8969 393.9304 395.3416 397.0956 399.1492 401.4520 403.9472 406.5733 409.2658];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [318.5446 318.3312 317.6965 316.6559 315.2352 313.4693 311.4017 309.0833 306.5712 303.9273 301.2166 298.5059 295.8620 293.3499 291.0315 288.9639 287.1980 285.7773 284.7367 284.1020 283.8887 284.1020 284.7367 285.7773 287.1980 288.9639 291.0315 293.3499 295.8620 298.5059 301.2166 303.9273 306.5712 309.0833 311.4017 313.4693 315.2352 316.6559 317.6965 318.3312 318.5446];
yPos = [415.5224 418.2331 420.8770 423.3891 425.7075 427.7751 429.5410 430.9617 432.0023 432.6370 432.8504 432.6370 432.0023 430.9617 429.5410 427.7751 425.7075 423.3891 420.8770 418.2331 415.5224 412.8117 410.1678 407.6557 405.3373 403.2697 401.5038 400.0831 399.0425 398.4078 398.1944 398.4078 399.0425 400.0831 401.5038 403.2697 405.3373 407.6557 410.1678 412.8117 415.5224];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [426.5538 426.3549 425.7623 424.7881 423.4520 421.7813 419.8101 417.5783 415.1315 412.5195 409.7954 407.0147 404.2340 401.5099 398.8978 396.4510 394.2193 392.2480 390.5773 389.2413 388.2670 387.6744 387.4755 387.6744 388.2670 389.2413 390.5773 392.2480 394.2193 396.4510 398.8978 401.5099 404.2340 407.0147 409.7954 412.5195 415.1315 417.5783 419.8101 421.7813 423.4520 424.7881 425.7623 426.3549 426.5538];
yPos = [416.0438 418.8245 421.5486 424.1606 426.6074 428.8392 430.8105 432.4811 433.8172 434.7914 435.3840 435.5829 435.3840 434.7914 433.8172 432.4811 430.8105 428.8392 426.6074 424.1606 421.5486 418.8245 416.0438 413.2631 410.5390 407.9269 405.4801 403.2484 401.2771 399.6064 398.2704 397.2961 396.7036 396.5047 396.7036 397.2961 398.2704 399.6064 401.2771 403.2484 405.4801 407.9269 410.5390 413.2631 416.0438];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

xPos = [527.2527 527.0429 526.4184 525.3948 523.9972 522.2601 520.2262 517.9455 515.4743 512.8734 510.2068 507.5403 504.9394 502.4682 500.1875 498.1536 496.4164 495.0189 493.9952 493.3708 493.1610 493.3708 493.9952 495.0189 496.4164 498.1536 500.1875 502.4682 504.9394 507.5403 510.2068 512.8734 515.4743 517.9455 520.2262 522.2601 523.9972 525.3948 526.4184 527.0429 527.2527];
yPos = [412.9155 415.5820 418.1829 420.6541 422.9348 424.9687 426.7059 428.1035 429.1271 429.7515 429.9614 429.7515 429.1271 428.1035 426.7059 424.9687 422.9348 420.6541 418.1829 415.5820 412.9155 410.2489 407.6480 405.1768 402.8962 400.8622 399.1251 397.7275 396.7039 396.0795 395.8696 396.0795 396.7039 397.7275 399.1251 400.8622 402.8962 405.1768 407.6480 410.2489 412.9155];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

% Create masked image.
maskedImage = img;
maskedImage(~BW) = 0;

%imshow(img);
imshow(maskedImage);

%imwrite(uint8(maskedImage),'C:\Users\z2m09\Desktop\bottles\inputs\output_8bit.png');
%Z = imread('C:\Users\z2m09\Desktop\bottles\inputs\output_8bit.png');
%num_circles = size(peaks,1);
   % disp(['Number of circles in ', Z, ': ', num2str(num_circles)]);





end
